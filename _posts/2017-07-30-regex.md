---
layout: post
title: bash正则表达式
tags:
- regex
- Regular Expression
categories: 正则表达式
description: linxu系统上，简单理解文件和目录的存储方式，从根本上理解软连接和硬链接

---
## 正则表达式
正则表达式`Regular Expression`,通常用来检索、替换那些符合某个模式`parttern` ，正则表达式的搜索引擎叫 PCRE `Perl Compatible Regular Expression` 
注意：有些程序支持正则表达式，在编译安装源码的时候有时候会报错没有PCRE，此时安装下这个库就可以了

<!-- more -->


> 正则表达式有两种

	
- 基本正则表达式

- 扩展正则表达式

### 基本正则表达式的元字符
*元字符:表示不是代表字符本身而是有特定的含义*

> 字符匹配

	. 				#匹配单个字符	
	[]				#匹配指定范围内的任意单个字符 	
	[^]				#匹配范围外的任意单个字符
	[:alumun:]			#字母和数字
	[:alpha:] 			#等价于[a-zA-Z]
	[:space:]			#空白字符
	[:digit:] 			#等价于[0-9]
	[:punct:] 			#标点符号

> 匹配次数

	*用于一个字符的后面，表示前面字符出现的次数*

	
	*	        	#表示任意次	
	\?		   	#0次或1次
	\+		   	#至少1次
	\{n\}	  		#n次
	\{n,m\}			#n次和m次之间
	\{,n\}			#最多n次
	\{m,\}			#最少M次

>  位置锚定

	^					 	#行首				
	$						#行尾
	^$	^$					#空行（中间没有空格）
	^[[:space:]]*$					#空白行 （中间可能有空格）
	\<				      		#单词词首
	\>			      			#单词词尾


> 分组和引用

	\(\)			#*用 \(\) 将字符串绑到一起，当做一个字符串处理，

	\1 \2  ..  		#表示引用前面第几个括号的匹配到的内容*

	\| 			#表示或者关系


### 用例子来理解正则表达式

> 匹配 0-255 之间的数字

*思路* 0-255 数字位数不一样，应该按1位数 2位数 3位数来分别表示
	
	0-9  		[0-9]
	10-99 		[1-9][0-9]
	100-199 	1[0-9][0-9]
	200-249		2[0-4][0-9]
	250-255		25[0-5]

用户或的关系串起来就是

	[root: ~]# ifconfig | grep -o "[0-9]\|[1-9][0-9]\|1[0-9][0-9]\|2[0-4][0-9]\|25[0-5]" 

> 精确匹配IP地址

	[root: ~]# ifconfig | grep -o "\(\([0-9]\|[1-9][0-9]\|1[0-9][0-9]\|2[0-4][0-9]\)\.\)\{3\}\([0-9]\|[1-9][0-9]\|1[0-9][0-9]\|2[0-4][0-9]\)"

> 输入一个路径，找出其基名和目录名 （类似`baename`和`dirname`）

- /etc/sysconfig/network-scripts/ifcfg-eth0
- /etc/rc.d/init.d/

*思路：匹配基名，因为不清楚路径到底有多长，而且有的带"/" ,有的不带。所以从后往前面匹配比较好找规律* ，
文字表达为：不以"/"结尾的字符串，后面可能带一个"/"

正则表达式表示为

	echo "/etc/sysconfig/network-scripts/eth0" | grep -o '[^/]\+/\?$'
	echo "/etc/rc.d/init.d/" | grep -o '[^/]\+/\?$'

*思路：匹配目录名，*
	 
先看一下`dirname`命令的显示结果

	[root: ~]# dirname /etc/rc.d/init.d/
	/etc/rc.d
	[root: ~]# dirname /etc/sysconfig/network-scripts/ifcfg-eth0 
	/etc/sysconfig/network-scripts

都是把最后一个“/”后面一部分去掉了。如果最后一个不带“/”，很容易 模式为 "/.*/" 即可匹配，要让grep的贪婪匹配模式匹配到，最后一个“/” 而且后面要有内容

正则表达式写法：

	[root: ~]# echo "/etc/rc.d/init.d/" | grep -o "/.*/"
	/etc/rc.d/init.d/				#直接这样表示会把后面的也取出来
	[root: ~]# echo "/etc/rc.d/init.d/" | grep -o "/.*/\<"
	/etc/rc.d/						#  加个 “\<”  显示出来就完全不一样   

*这个 "/<" 词首锚定还有这样的功效，真是不试不知道*

